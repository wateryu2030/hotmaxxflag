# 好特卖超级仓 — 经营展示方案建议

> 基于 3 张核心表（库存、销售、毛利）分析，给出可落地的展示方案，帮助看清卖场实际经营情况。

---

## 一、三张表结构与业务含义

| 表名 | 粒度 | 核心字段 | 业务价值 |
|------|------|----------|----------|
| **t_htma_stock** 库存表 | 日期 + 商品编码 | data_date, sku_code, category, stock_qty, stock_amount, store_id | 反映当日库存结构与金额，支撑补货与周转分析 |
| **t_htma_sale** 销售表 | 日期 + 商品编码 | data_date, sku_code, category, sale_qty, sale_amount, sale_cost, gross_profit, store_id | 反映单品销售与毛利，用于畅销/滞销与品类分析 |
| **t_htma_profit** 毛利表 | 日期 + 品类 + 门店 | data_date, category, total_sale, total_profit, profit_rate, store_id | 反映品类级销售与毛利，支撑经营决策与趋势分析 |

**关联关系**：`data_date`、`sku_code`、`category`、`store_id` 可跨表关联。

---

## 二、建议展示层级（由上到下）

### 第一层：经营总览（高管视角）

| 指标 | 数据来源 | 展示形式 | 说明 |
|------|----------|----------|------|
| 总销售额 | t_htma_profit 汇总 | 数字卡片 | 选定区间内总销售额 |
| 总毛利 | t_htma_profit 汇总 | 数字卡片 | 选定区间内总毛利 |
| 平均毛利率 | 总毛利/总销售额 | 数字卡片 | 建议按阈值着色：≥35% 绿，<35% 黄 |
| 库存总额 | t_htma_stock 最新日期 | 数字卡片 | 反映当前存货占用资金 |

**时间筛选**：默认「近 30 天」，支持按日/周/月切换。

---

### 第二层：品类经营分析（品类/采购视角）

| 组件 | 数据来源 | 展示形式 | 洞察目的 |
|------|----------|----------|----------|
| 品类销售额占比 | t_htma_sale / t_htma_profit | 饼图（Top5 + 其他） | 看哪些品类贡献主要收入 |
| 品类毛利贡献 | t_htma_profit | 柱状图（按品类） | 比较各品类毛利贡献 |
| 品类毛利率分布 | t_htma_profit | 柱状图或热力图 | 识别高毛利/低毛利品类 |
| 品类销售趋势 | t_htma_profit 按日/周/月 | 折线图 | 观察品类增长或下滑 |

**建议**：饼图只展示 Top5，其余归为「其他」，避免品类过多导致图表难读。

---

### 第三层：销售与毛利趋势（运营视角）

| 组件 | 分析维度 | 展示形式 | 业务意义 |
|------|----------|----------|----------|
| 日销售额趋势 | t_htma_profit | 柱状图 | 看日销售波动与峰值 |
| 日环比 | (当日 - 前日) / 前日 | 折线图叠加 | 观察短期变化 |
| 周同比 | 本周 vs 上周 | 数字或折线 | 判断周度改善或恶化 |
| 毛利率趋势 | t_htma_profit | 折线图 | 监控毛利水平变化 |

---

### 第四层：库存与周转（补货/仓管视角）

| 组件 | 数据来源 | 展示形式 | 洞察目的 |
|------|----------|----------|----------|
| 低库存预警 | t_htma_stock | 数字卡片 + 明细表 | 及时补货，避免缺货 |
| 库存-销售明细 | stock + sale 关联 | 明细表（可筛选、排序） | 结合库存与销售判断补货优先级 |
| 库存金额分布 | t_htma_stock 按品类 | 饼图或柱状图 | 看资金占用结构与品类重心 |

**预警规则**：库存数量 < 阈值（如 50）标记为「低库存」，可按品类或门店分别设置阈值。

---

### 第五层：单品明细（深入分析）

| 组件 | 数据来源 | 展示形式 | 洞察目的 |
|------|----------|----------|----------|
| 畅销商品 Top N | t_htma_sale | 表格 | 识别核心 SKU |
| 滞销商品 | t_htma_sale（低销量） | 表格 | 评估清仓或下架 |
| 高毛利单品 | t_htma_sale | 表格 | 重点推广与陈列 |
| 低毛利/负毛利单品 | t_htma_sale | 表格 | 排查定价或成本问题 |

---

## 三、落地实施路径

### 方案 A：在现有 JimuReport 中扩展（推荐）

当前已有「好特卖销售明细」报表（8946110000000000001），以毛利表为主。建议：

1. **新增报表**：
   - **好特卖经营总览**：4 个 KPI 卡片 + 日期筛选
   - **好特卖品类分析**：饼图 + 柱状图
   - **好特卖销售趋势**：日销售 + 环比
   - **好特卖库存预警**：预警卡片 + 明细表

2. **使用 BI 大屏**（JimuReport 的 drag 功能）：
   - 仪表盘设计 → 新建「好特卖沈阳超级仓运营看板」
   - 按上述层级布局：顶部 KPI → 左侧品类 → 右侧趋势 → 底部库存预警

3. **复用现有 SQL**：`scripts/jimureport/` 下已有 01a~01d、02、03、04 等 SQL，可直接作为数据集使用。

### 方案 B：新增仪表盘页面

在 JimuReport 的 BI 大屏中新建仪表盘，一次性实现总览 + 品类 + 趋势 + 库存。步骤：

1. 访问 `http://127.0.0.1:8085/drag/list`
2. 新建仪表盘 → 命名「好特卖沈阳超级仓运营看板」
3. 按「二、建议展示层级」添加组件并绑定数据集
4. 配置全局日期筛选器，联动所有组件

---

## 四、推荐看板布局示意

```
┌─────────────────────────────────────────────────────────────────┐
│  好特卖沈阳超级仓运营看板                    [日期筛选: 近30天 ▼] │
├─────────────┬─────────────┬─────────────┬─────────────────────┤
│ 总销售额     │ 总毛利       │ 平均毛利率   │ 库存总额              │
│ 1,234,567   │ 234,567     │ 19.0%       │ 567,890              │
├─────────────┴─────────────┴─────────────┴─────────────────────┤
│                                                                  │
│  ┌──────────────────────┐  ┌────────────────────────────────┐ │
│  │ 品类销售额占比（饼图）  │  │ 日销售额趋势（柱状图 + 环比折线） │ │
│  │ Top5 + 其他           │  │ 近30天每日销售额与环比变化       │ │
│  └──────────────────────┘  └────────────────────────────────┘ │
│                                                                  │
│  ┌──────────────────────┐  ┌────────────────────────────────┐ │
│  │ 品类毛利贡献（柱状图）  │  │ 低库存预警                     │ │
│  │ 各品类毛利对比        │  │ 预警SKU数 | 明细表（可导出）   │ │
│  └──────────────────────┘  └────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

---

## 五、需确认的数据情况

在正式落地前，建议确认：

| 检查项 | 说明 |
|--------|------|
| 库存表是否有数据 | `SELECT COUNT(*) FROM t_htma_stock WHERE store_id='沈阳超级仓'` |
| 销售表是否有数据 | `SELECT COUNT(*) FROM t_htma_sale WHERE store_id='沈阳超级仓'` |
| 毛利表是否有数据 | 已有（当前好特卖销售明细报表 13235 条） |
| 日期范围 | 确认三表日期范围是否一致，便于跨表分析 |
| 品类覆盖 | 检查品类是否完整，是否存在大量「未分类」 |

---

## 六、快速验证 SQL

```sql
-- 1. 各表数据量
SELECT 'stock' AS tbl, COUNT(*) AS cnt FROM htma_dashboard.t_htma_stock
UNION ALL
SELECT 'sale', COUNT(*) FROM htma_dashboard.t_htma_sale
UNION ALL
SELECT 'profit', COUNT(*) FROM htma_dashboard.t_htma_profit;

-- 2. 毛利表日期范围
SELECT MIN(data_date), MAX(data_date), COUNT(DISTINCT category)
FROM htma_dashboard.t_htma_profit
WHERE store_id = '沈阳超级仓';
```

---

## 七、关联文件

| 文件 | 用途 |
|------|------|
| `scripts/01_create_tables.sql` | 建表 |
| `scripts/02_data_cleaning.sql` | 数据清洗 |
| `scripts/jimureport/01a~01d_*.sql` | KPI 数字卡片 |
| `scripts/jimureport/02_category_analysis.sql` | 品类分析 |
| `scripts/jimureport/03_yoy_mom_trend.sql` | 趋势分析 |
| `scripts/jimureport/04_inventory_alert.sql` | 库存预警 |
| `docs/好特卖超级仓数据看板实施方案.md` | 详细实施步骤 |
